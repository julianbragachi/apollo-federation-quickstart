"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ApolloOpenTelemetry = void 0;
const api_1 = require("@opentelemetry/api");
const exporter_trace_otlp_http_1 = require("@opentelemetry/exporter-trace-otlp-http");
const exporter_zipkin_1 = require("@opentelemetry/exporter-zipkin");
const instrumentation_1 = require("@opentelemetry/instrumentation");
const instrumentation_express_1 = require("@opentelemetry/instrumentation-express");
const instrumentation_graphql_1 = require("@opentelemetry/instrumentation-graphql");
const instrumentation_http_1 = require("@opentelemetry/instrumentation-http");
const resources_1 = require("@opentelemetry/resources");
const sdk_trace_base_1 = require("@opentelemetry/sdk-trace-base");
const sdk_trace_node_1 = require("@opentelemetry/sdk-trace-node");
var GraphNodeType;
(function (GraphNodeType) {
    GraphNodeType["Router"] = "router";
    GraphNodeType["Subgraph"] = "subgraph";
})(GraphNodeType || (GraphNodeType = {}));
var ExporterType;
(function (ExporterType) {
    ExporterType["Console"] = "console";
    ExporterType["Zipkin"] = "zipkin";
    ExporterType["Collector"] = "collector";
})(ExporterType || (ExporterType = {}));
class ApolloOpenTelemetry {
    constructor(props) {
        this.props = props;
        if (props.debug) {
            api_1.diag.setLogger(new api_1.DiagConsoleLogger(), api_1.DiagLogLevel.DEBUG);
        }
    }
    setupInstrumentation() {
        var _a, _b, _c, _d, _e;
        const name = (_a = this.props.name) !== null && _a !== void 0 ? _a : this.props.type;
        const resource = new resources_1.Resource({
            'service.name': name,
        });
        const instrumentations = [];
        switch (this.props.type) {
            case GraphNodeType.Router:
                instrumentations.push(new instrumentation_http_1.HttpInstrumentation());
                instrumentations.push(new instrumentation_express_1.ExpressInstrumentation());
                break;
            case GraphNodeType.Subgraph:
                instrumentations.push(new instrumentation_http_1.HttpInstrumentation());
                instrumentations.push(new instrumentation_express_1.ExpressInstrumentation());
                instrumentations.push(new instrumentation_graphql_1.GraphQLInstrumentation({
                    allowValues: true,
                    depth: 10,
                }));
                break;
            default:
                throw new Error(`unknown graph node type: '${this.props.type}'`);
        }
        (0, instrumentation_1.registerInstrumentations)({
            instrumentations: [instrumentations],
        });
        const provider = new sdk_trace_node_1.NodeTracerProvider({
            resource: resources_1.Resource.default().merge(resource),
        });
        const exporter = this.props.exporter;
        const exporterType = (_b = exporter === null || exporter === void 0 ? void 0 : exporter.type) !== null && _b !== void 0 ? _b : ExporterType.Console;
        const host = (_c = exporter === null || exporter === void 0 ? void 0 : exporter.host) !== null && _c !== void 0 ? _c : 'localhost';
        switch (exporterType) {
            case ExporterType.Console:
                const consoleExporter = new sdk_trace_base_1.ConsoleSpanExporter();
                provider.addSpanProcessor(new sdk_trace_base_1.SimpleSpanProcessor(consoleExporter));
                break;
            case ExporterType.Zipkin:
                const zipkinPort = (_d = exporter === null || exporter === void 0 ? void 0 : exporter.port) !== null && _d !== void 0 ? _d : '9411';
                const zipkinExporter = new exporter_zipkin_1.ZipkinExporter({
                    url: `http://${host}:${zipkinPort}/api/v2/spans`,
                });
                provider.addSpanProcessor(new sdk_trace_base_1.SimpleSpanProcessor(zipkinExporter));
                break;
            case ExporterType.Collector:
                const collectorPort = (_e = exporter === null || exporter === void 0 ? void 0 : exporter.port) !== null && _e !== void 0 ? _e : '4318';
                const collectorTraceExporter = new exporter_trace_otlp_http_1.OTLPTraceExporter({
                    url: `http://${host}:${collectorPort}/v1/traces`,
                });
                provider.addSpanProcessor(new sdk_trace_base_1.BatchSpanProcessor(collectorTraceExporter, {
                    maxQueueSize: 1000,
                    scheduledDelayMillis: 1000,
                }));
                break;
            default:
                throw new Error(`unknown exporter type: '${exporterType}'`);
        }
        provider.register();
    }
}
exports.ApolloOpenTelemetry = ApolloOpenTelemetry;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsNENBQTJFO0FBRTNFLHNGQUE0RTtBQUM1RSxvRUFBZ0U7QUFDaEUsb0VBR3dDO0FBQ3hDLG9GQUFnRjtBQUVoRixvRkFBZ0Y7QUFDaEYsOEVBQTBFO0FBQzFFLHdEQUFvRDtBQUNwRCxrRUFBNkc7QUFDN0csa0VBQW1FO0FBR25FLElBQUssYUFHSjtBQUhELFdBQUssYUFBYTtJQUNoQixrQ0FBaUIsQ0FBQTtJQUNqQixzQ0FBcUIsQ0FBQTtBQUN2QixDQUFDLEVBSEksYUFBYSxLQUFiLGFBQWEsUUFHakI7QUFFRCxJQUFLLFlBSUo7QUFKRCxXQUFLLFlBQVk7SUFDZixtQ0FBbUIsQ0FBQTtJQUNuQixpQ0FBaUIsQ0FBQTtJQUNqQix1Q0FBdUIsQ0FBQTtBQUN6QixDQUFDLEVBSkksWUFBWSxLQUFaLFlBQVksUUFJaEI7QUFnQkQsTUFBYSxtQkFBbUI7SUFHOUIsWUFBbUIsS0FBK0I7UUFDaEQsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFFbkIsSUFBSSxLQUFLLENBQUMsS0FBSyxFQUFFO1lBQ2YsVUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLHVCQUFpQixFQUFFLEVBQUUsa0JBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUM3RDtJQUNILENBQUM7SUFFTSxvQkFBb0I7O1FBQ3pCLE1BQU0sSUFBSSxHQUFHLE1BQUEsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLG1DQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDO1FBQ2hELE1BQU0sUUFBUSxHQUFHLElBQUksb0JBQVEsQ0FBQztZQUM1QixjQUFjLEVBQUUsSUFBSTtTQUNyQixDQUFDLENBQUM7UUFFSCxNQUFNLGdCQUFnQixHQUFzQixFQUFFLENBQUM7UUFDL0MsUUFBUSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRTtZQUN2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a0RBMEZDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGlhZywgRGlhZ0NvbnNvbGVMb2dnZXIsIERpYWdMb2dMZXZlbCB9IGZyb20gJ0BvcGVudGVsZW1ldHJ5L2FwaSc7XG5cbmltcG9ydCB7IE9UTFBUcmFjZUV4cG9ydGVyIH0gZnJvbSAnQG9wZW50ZWxlbWV0cnkvZXhwb3J0ZXItdHJhY2Utb3RscC1odHRwJztcbmltcG9ydCB7IFppcGtpbkV4cG9ydGVyIH0gZnJvbSAnQG9wZW50ZWxlbWV0cnkvZXhwb3J0ZXItemlwa2luJztcbmltcG9ydCB7XG4gIEluc3RydW1lbnRhdGlvbixcbiAgcmVnaXN0ZXJJbnN0cnVtZW50YXRpb25zLFxufSBmcm9tICdAb3BlbnRlbGVtZXRyeS9pbnN0cnVtZW50YXRpb24nO1xuaW1wb3J0IHsgRXhwcmVzc0luc3RydW1lbnRhdGlvbiB9IGZyb20gJ0BvcGVudGVsZW1ldHJ5L2luc3RydW1lbnRhdGlvbi1leHByZXNzJztcblxuaW1wb3J0IHsgR3JhcGhRTEluc3RydW1lbnRhdGlvbiB9IGZyb20gJ0BvcGVudGVsZW1ldHJ5L2luc3RydW1lbnRhdGlvbi1ncmFwaHFsJztcbmltcG9ydCB7IEh0dHBJbnN0cnVtZW50YXRpb24gfSBmcm9tICdAb3BlbnRlbGVtZXRyeS9pbnN0cnVtZW50YXRpb24taHR0cCc7XG5pbXBvcnQgeyBSZXNvdXJjZSB9IGZyb20gJ0BvcGVudGVsZW1ldHJ5L3Jlc291cmNlcyc7XG5pbXBvcnQgeyBCYXRjaFNwYW5Qcm9jZXNzb3IsIENvbnNvbGVTcGFuRXhwb3J0ZXIsIFNpbXBsZVNwYW5Qcm9jZXNzb3IgfSBmcm9tICdAb3BlbnRlbGVtZXRyeS9zZGstdHJhY2UtYmFzZSc7XG5pbXBvcnQgeyBOb2RlVHJhY2VyUHJvdmlkZXIgfSBmcm9tICdAb3BlbnRlbGVtZXRyeS9zZGstdHJhY2Utbm9kZSc7XG5cblxuZW51bSBHcmFwaE5vZGVUeXBlIHtcbiAgUm91dGVyID0gJ3JvdXRlcicsXG4gIFN1YmdyYXBoID0gJ3N1YmdyYXBoJyxcbn1cblxuZW51bSBFeHBvcnRlclR5cGUge1xuICBDb25zb2xlID0gJ2NvbnNvbGUnLFxuICBaaXBraW4gPSAnemlwa2luJyxcbiAgQ29sbGVjdG9yID0gJ2NvbGxlY3RvcicsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXBvbGxvT3BlblRlbGVtZXRyeUV4cG9ydGVyUHJvcHMge1xuICByZWFkb25seSB0eXBlOiBFeHBvcnRlclR5cGU7XG4gIHJlYWRvbmx5IGhvc3Q/OiBzdHJpbmc7XG4gIHJlYWRvbmx5IHBvcnQ/OiBzdHJpbmc7XG59XG5cblxuZXhwb3J0IGludGVyZmFjZSBBcG9sbG9PcGVuVGVsZW1ldHJ5UHJvcHMge1xuICByZWFkb25seSB0eXBlOiBHcmFwaE5vZGVUeXBlO1xuICByZWFkb25seSBuYW1lPzogc3RyaW5nO1xuICByZWFkb25seSBleHBvcnRlcj86IEFwb2xsb09wZW5UZWxlbWV0cnlFeHBvcnRlclByb3BzO1xuICByZWFkb25seSBkZWJ1Zz86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBBcG9sbG9PcGVuVGVsZW1ldHJ5IHtcbiAgcHJpdmF0ZSBwcm9wczogQXBvbGxvT3BlblRlbGVtZXRyeVByb3BzXG5cbiAgcHVibGljIGNvbnN0cnVjdG9yKHByb3BzOiBBcG9sbG9PcGVuVGVsZW1ldHJ5UHJvcHMpIHtcbiAgICB0aGlzLnByb3BzID0gcHJvcHM7XG5cbiAgICBpZiAocHJvcHMuZGVidWcpIHtcbiAgICAgIGRpYWcuc2V0TG9nZ2VyKG5ldyBEaWFnQ29uc29sZUxvZ2dlcigpLCBEaWFnTG9nTGV2ZWwuREVCVUcpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBzZXR1cEluc3RydW1lbnRhdGlvbigpIHtcbiAgICBjb25zdCBuYW1lID0gdGhpcy5wcm9wcy5uYW1lID8/IHRoaXMucHJvcHMudHlwZTtcbiAgICBjb25zdCByZXNvdXJjZSA9IG5ldyBSZXNvdXJjZSh7XG4gICAgICAnc2VydmljZS5uYW1lJzogbmFtZSxcbiAgICB9KTtcblxuICAgIGNvbnN0IGluc3RydW1lbnRhdGlvbnM6IEluc3RydW1lbnRhdGlvbltdID0gW107XG4gICAgc3dpdGNoICh0aGlzLnByb3BzLnR5cGUpIHtcbiAgICAgIGNhc2UgR3JhcGhOb2RlVHlwZS5Sb3V0ZXI6XG4gICAgICAgIGluc3RydW1lbnRhdGlvbnMucHVzaCggbmV3IEh0dHBJbnN0cnVtZW50YXRpb24oKSApO1xuICAgICAgICBpbnN0cnVtZW50YXRpb25zLnB1c2goIG5ldyBFeHByZXNzSW5zdHJ1bWVudGF0aW9uKCkgKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgR3JhcGhOb2RlVHlwZS5TdWJncmFwaDpcbiAgICAgICAgaW5zdHJ1bWVudGF0aW9ucy5wdXNoKCBuZXcgSHR0cEluc3RydW1lbnRhdGlvbigpICk7XG4gICAgICAgIGluc3RydW1lbnRhdGlvbnMucHVzaCggbmV3IEV4cHJlc3NJbnN0cnVtZW50YXRpb24oKSApO1xuICAgICAgICBpbnN0cnVtZW50YXRpb25zLnB1c2goXG4gICAgICAgICAgbmV3IEdyYXBoUUxJbnN0cnVtZW50YXRpb24oe1xuICAgICAgICAgICAgYWxsb3dWYWx1ZXM6IHRydWUsXG4gICAgICAgICAgICBkZXB0aDogMTAsXG4gICAgICAgICAgfSksXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHVua25vd24gZ3JhcGggbm9kZSB0eXBlOiAnJHt0aGlzLnByb3BzLnR5cGV9J2ApO1xuICAgIH1cblxuICAgIHJlZ2lzdGVySW5zdHJ1bWVudGF0aW9ucyh7XG4gICAgICBpbnN0cnVtZW50YXRpb25zOiBbaW5zdHJ1bWVudGF0aW9uc10sXG4gICAgfSk7XG4gICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgTm9kZVRyYWNlclByb3ZpZGVyKHtcbiAgICAgIHJlc291cmNlOiBSZXNvdXJjZS5kZWZhdWx0KCkubWVyZ2UocmVzb3VyY2UpLFxuICAgIH0pO1xuXG4gICAgY29uc3QgZXhwb3J0ZXIgPSB0aGlzLnByb3BzLmV4cG9ydGVyO1xuICAgIGNvbnN0IGV4cG9ydGVyVHlwZSA9IGV4cG9ydGVyPy50eXBlID8/IEV4cG9ydGVyVHlwZS5Db25zb2xlO1xuICAgIGNvbnN0IGhvc3QgPSBleHBvcnRlcj8uaG9zdCA/PyAnbG9jYWxob3N0JztcblxuICAgIHN3aXRjaCAoZXhwb3J0ZXJUeXBlKSB7XG4gICAgICBjYXNlIEV4cG9ydGVyVHlwZS5Db25zb2xlOlxuICAgICAgICBjb25zdCBjb25zb2xlRXhwb3J0ZXIgPSBuZXcgQ29uc29sZVNwYW5FeHBvcnRlcigpO1xuICAgICAgICBwcm92aWRlci5hZGRTcGFuUHJvY2Vzc29yKFxuICAgICAgICAgIG5ldyBTaW1wbGVTcGFuUHJvY2Vzc29yKGNvbnNvbGVFeHBvcnRlciksXG4gICAgICAgICk7XG5cbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgRXhwb3J0ZXJUeXBlLlppcGtpbjpcbiAgICAgICAgY29uc3Qgemlwa2luUG9ydCA9IGV4cG9ydGVyPy5wb3J0ID8/ICc5NDExJztcblxuICAgICAgICBjb25zdCB6aXBraW5FeHBvcnRlciA9IG5ldyBaaXBraW5FeHBvcnRlcih7XG4gICAgICAgICAgdXJsOiBgaHR0cDovLyR7aG9zdH06JHt6aXBraW5Qb3J0fS9hcGkvdjIvc3BhbnNgLFxuICAgICAgICB9KTtcbiAgICAgICAgcHJvdmlkZXIuYWRkU3BhblByb2Nlc3NvcihcbiAgICAgICAgICBuZXcgU2ltcGxlU3BhblByb2Nlc3Nvcih6aXBraW5FeHBvcnRlciksXG4gICAgICAgICk7XG5cbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgRXhwb3J0ZXJUeXBlLkNvbGxlY3RvcjpcbiAgICAgICAgY29uc3QgY29sbGVjdG9yUG9ydCA9IGV4cG9ydGVyPy5wb3J0ID8/ICc0MzE4JztcblxuICAgICAgICBjb25zdCBjb2xsZWN0b3JUcmFjZUV4cG9ydGVyID0gbmV3IE9UTFBUcmFjZUV4cG9ydGVyKHtcbiAgICAgICAgICB1cmw6IGBodHRwOi8vJHtob3N0fToke2NvbGxlY3RvclBvcnR9L3YxL3RyYWNlc2AsXG4gICAgICAgIH0pO1xuICAgICAgICBwcm92aWRlci5hZGRTcGFuUHJvY2Vzc29yKFxuICAgICAgICAgIG5ldyBCYXRjaFNwYW5Qcm9jZXNzb3IoY29sbGVjdG9yVHJhY2VFeHBvcnRlciwge1xuICAgICAgICAgICAgbWF4UXVldWVTaXplOiAxMDAwLFxuICAgICAgICAgICAgc2NoZWR1bGVkRGVsYXlNaWxsaXM6IDEwMDAsXG4gICAgICAgICAgfSksXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHVua25vd24gZXhwb3J0ZXIgdHlwZTogJyR7ZXhwb3J0ZXJUeXBlfSdgKTtcbiAgICB9XG4gICAgcHJvdmlkZXIucmVnaXN0ZXIoKTtcbiAgfVxufVxuIl19